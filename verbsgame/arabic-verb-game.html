<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>üìò Arabic Verb Practice</title>
  <style>
    body {
      font-family: 'Segoe UI', sans-serif;
      background-color: #f9fbfd;
      margin: 0;
      padding: 0;
    }
    .navbar {
      background-color: #0a4d68;
      color: white;
      padding: 15px 20px;
      font-size: 20px;
      font-weight: bold;
    }
    .game-container {
      margin: 40px auto;
      background: white;
      padding: 30px 40px;
      border-radius: 12px;
      box-shadow: 0 6px 20px rgba(0,0,0,0.1);
      max-width: 600px;
      width: 100%;
    }
    h2 {
      margin-bottom: 16px;
      color: #0a4d68;
      text-align: center;
    }
    .question {
      font-size: 20px;
      margin-bottom: 20px;
      text-align: center;
    }
    .options {
      display: flex;
      flex-direction: column;
      gap: 10px;
    }
    .option-btn {
      background-color: #e6f0ff;
      border: 1px solid #ccc;
      padding: 10px 20px;
      border-radius: 8px;
      cursor: pointer;
      font-size: 16px;
      text-align: center;
      transition: background-color 0.3s;
    }
    .option-btn.selected {
      background-color: #cce0ff;
    }
    .option-btn.correct {
      background-color: #a0e8af;
    }
    .option-btn.wrong {
      background-color: #f4a6a6;
    }
    .feedback {
      margin-top: 20px;
      text-align: center;
      font-weight: bold;
      font-size: 18px;
    }
    .submit-btn, .next-btn {
      margin-top: 25px;
      display: block;
      width: 100%;
      padding: 12px;
      font-size: 16px;
      background-color: #0a4d68;
      color: white;
      border: none;
      border-radius: 8px;
      cursor: pointer;
    }
    .submit-btn:disabled {
      background-color: #888;
      cursor: not-allowed;
    }
    .progress-bar {
      height: 10px;
      background-color: #d0e4ff;
      margin-top: 15px;
      border-radius: 6px;
      overflow: hidden;
    }
    .progress {
      height: 100%;
      width: 0%;
      background-color: #0a4d68;
      transition: width 0.3s;
    }
  </style>
</head>
<body>

<div class="navbar">üìò Arabic Verb Practice</div>

<div class="game-container">
  <h2>üî§ Arabic Verb Game</h2>
  <div class="question" id="question">Loading...</div>
  <div class="options" id="options"></div>
  <button class="submit-btn" id="submitBtn" onclick="submitAnswer()" disabled>Submit Answer</button>
  <div class="feedback" id="feedback"></div>
  <div class="progress-bar"><div class="progress" id="progress"></div></div>
  <button class="next-btn" id="nextBtn" onclick="nextQuestion()" style="display:none;">Next ‚û°Ô∏è</button>
</div>


<script src="verb_data.js"></script>

<script>
let currentIndex = 0;
let gameWords = [];
let currentQuestion = {};
let mode = "";
const totalQuestions = 10;
let selectedOption = null;
let score = 0;

function shuffle(arr) {
  return arr.sort(() => Math.random() - 0.5);
}

function loadGame() {
  gameWords = shuffle(dataset).slice(0, totalQuestions);
  loadQuestion();
}

function loadQuestion() {
  if (currentIndex >= totalQuestions) {
    showFinalScore();
    return;
  }

  selectedOption = null;
  const questionEl = document.getElementById("question");
  const optionsEl = document.getElementById("options");
  const feedback = document.getElementById("feedback");
  const progress = document.getElementById("progress");
  const submitBtn = document.getElementById("submitBtn");
  const nextBtn = document.getElementById("nextBtn");

  feedback.innerHTML = "";
  optionsEl.innerHTML = "";
  submitBtn.disabled = true;
  nextBtn.style.display = "none";

  currentQuestion = gameWords[currentIndex];
  mode = Math.random() > 0.5 ? "A2E" : "E2A";

  const others = shuffle(dataset.filter(d => d !== currentQuestion)).slice(0, 3);
  const options = shuffle([currentQuestion, ...others]);

  questionEl.innerHTML = mode === "A2E"
    ? `What does <b>${currentQuestion["3MSAP_root"]}</b> mean?`
    : `Which Arabic word means <b>${currentQuestion.meaning}</b>?`;

  options.forEach(option => {
    const btn = document.createElement("button");
    btn.className = "option-btn";
    btn.textContent = mode === "A2E" ? option.meaning : option["3MSAP_root"];
    btn.onclick = () => {
      document.querySelectorAll('.option-btn').forEach(b => b.classList.remove("selected"));
      btn.classList.add("selected");
      selectedOption = option;
      submitBtn.disabled = false;
    };
    optionsEl.appendChild(btn);
  });

  progress.style.width = `${(currentIndex / totalQuestions) * 100}%`;
}

function submitAnswer() {
  const feedback = document.getElementById("feedback");
  const nextBtn = document.getElementById("nextBtn");

  if (!selectedOption) return;

  const isCorrect = (mode === "A2E" && selectedOption.meaning === currentQuestion.meaning)
                 || (mode === "E2A" && selectedOption["3MSAP_root"] === currentQuestion["3MSAP_root"]);

  document.querySelectorAll('.option-btn').forEach(btn => {
    const btnValue = btn.textContent;
    const correctValue = mode === "A2E" ? currentQuestion.meaning : currentQuestion["3MSAP_root"];
    if (btnValue === correctValue) {
      btn.classList.add("correct");
    } else if (btn.classList.contains("selected")) {
      btn.classList.add("wrong");
    }
    btn.disabled = true;
  });

  feedback.innerHTML = isCorrect ? "‚úÖ Correct!" : `‚ùå Incorrect. Correct answer: ${mode === "A2E" ? currentQuestion.meaning : currentQuestion["3MSAP_root"]}`;
  feedback.style.color = isCorrect ? "green" : "red";

  if (isCorrect) score++;

  nextBtn.style.display = "block";
  document.getElementById("submitBtn").disabled = true;
}

function nextQuestion() {
  currentIndex++;
  loadQuestion();
}

function showFinalScore() {
  const percent = Math.round((score / totalQuestions) * 100);
  document.getElementById("question").innerHTML = `üéØ Game Over! Your Score: <b>${percent}%</b>`;
  document.getElementById("options").innerHTML = "";
  document.getElementById("feedback").innerHTML = "";
  document.getElementById("submitBtn").style.display = "none";
  document.getElementById("nextBtn").style.display = "none";
  document.querySelector(".progress").style.width = "100%";
}

window.onload = loadGame;
</script>
</body>
</html>
